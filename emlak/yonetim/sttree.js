/*=======Ver:2.30.70930========*/
/*TreeMenu, (c) 2007, SourceTec Software Co.,LTD  -  www.sothink.com*/
if(typeof _STJS!="undefined"){_STJS._STTREE=new function(){this.init=function(){_STJS.registerMod("sttree.js");_STJS.completeMod("sttree.js",this);};this.create=function(a){var i,_r=_STJS,_e=_r._STTREE,ct,cs,cn,n,j,_a=0,_b;for(i=0;i<a.length;i++){switch(a[i].tag){case "tree":n=_r.structs.length;_r.structs[n]=ct=new _e.tree(a[i].id+n,a[i].as);with(ct){uid=a[i].id;nid=n;self="_STJS.structs["+n+"]";if(saveState&&_r.readCookieByName(uid)){useCookie=1;}if(ct.highlight&1){_r.checks.push(new Function("return "+ct.self+".checkHL()"));}}break;case "/tree":if(ct&&ct.subTrees.length){if(ct.showLevel1){for(j=0;j<ct.subTrees[0].nodes.length;j++){if(ct.subTrees[0].nodes[j].sSubTreeId!=-1){ct.subTrees[0].nodes[j].state|=1;ct.subTrees[ct.subTrees[0].nodes[j].sSubTreeId].state|=1;}}}if(ct.saveState){ct.setMsg("ST_UPDATE",_e.onTreeUpdate);for(var j=0;j<ct.subTrees.length;j++){for(var k=0;k<ct.subTrees[j].nodes.length;k++){with(ct.subTrees[j].nodes[k]){attachEvent("click",ct.self+".getMsg('ST_UPDATE');true;");attachEvent("clickFlag",ct.self+".getMsg('ST_UPDATE');true;");attachEvent("clickIcon",ct.self+".getMsg('ST_UPDATE');true;");}}}_STJS.loads.push(new Function("_STJS._STTREE.getTreeCookie("+ct.self+")"));}_STJS.addObjById(ct.id,ct);}else{if(ct&&!ct.subTrees.length){_r.structs.pop();ct=cs=cn=0;}}break;case "subtree":if(!ct){return false;}n=ct.subTrees.length;ct.subTrees[n]=cs=new _e.subtree(ct.id+"_"+n,a[i].as);with(cs){uid=a[i].id;nid=n;offsetPar=ct;self=ct.self+".subTrees["+n+"]";treeId=ct.nid;if(!n){state=1;}pNodeId=cn?cn.nid:-1;pSubTreeId=cn?cn.pSubTreeId:-1;depth=cn?ct.subTrees[cn.pSubTreeId].depth+1:0;padding=ct.padding;var _d=cs.nid>0?ct.subTrees[cs.pSubTreeId].nodes[cs.pNodeId].iconWidth:0;if(n>0){if(ct.type==1&&n==1){cs.flagOutWidth=0;}else{cs.flagOutWidth=ct.indent>-1?ct.indent:(Math.max(_d,ct.flagWidth)?Math.max(_d,ct.flagWidth):9)+2*ct.padding;}}else{if(ct.topFlag){cs.flagOutWidth=ct.indent>-1?ct.indent:(ct.flagWidth?ct.flagWidth:9)+2*ct.padding;}}getIndents();setMsg("ST_EXPAND",_e.onExpandSubTree);setMsg("ST_COLLAPSE",_e.onCollapseSubTree);}if(cn){cn.sSubTreeId=n;cn.collapsedFlag=ct.useFlag?ct.collapsedFlag:"";cn.expandedFlag=ct.useFlag?ct.expandedFlag:"";cn.flagWidth=cn.pSubTreeId>0||ct.topFlag?ct.flagWidth:0;cn.flagHeight=cn.pSubTreeId>0||ct.topFlag?ct.flagHeight:0;if(!ct.showLevel1||cn.pSubTreeId>0){cn.attachEvent("clickFlag",cn.self+".expandOrCollapse();false;");cn.attachEvent("clickIcon",cn.self+".expandOrCollapse();false;");}else{cn.lock=true;}}if(cs.isExpand==1&&cs.nid>0&&!ct.useCookie){var st=cs;st.state|=1;while(st.pSubTreeId!=-1){var pn=st.pNodeId;st=ct.subTrees[st.pSubTreeId];st.nodes[pn].state|=1;if(st.isExpand==2){break;}st.isExpand=2;st.state|=1;}}break;case "/subtree":if(!ct||!cs){return false;}var st=cs;n=cs.nid,_b=cs.pNodeId;if(n>0){cs=ct.subTrees[cs.pSubTreeId];cn=cs.nodes[_b];}else{cs=cn=0;}if(!st.nodes.length){if(cn){cn.sSubTreeId=-1;cn.collapsedFlag="";cn.expandedFlag="";cn.flagWidth=cs.nid>0?ct.flagWidth:(ct.topFlag?ct.flagWidth:0);cn.flagHeight=cs.nid>0||ct.topFlag?1:0;cn.detachEvent("clickFlag",cn.self+".expandOrCollapse()");cn.detachEvent("clickIcon",cn.self+".expandOrCollapse()");}ct.subTrees.pop();}else{_STJS.addObjById(st.id,st);}break;case "node":if(!ct||!cs){return false;}n=cs.nodes.length;with(a[i]){as[1]=ct.getPath("link",as[1]);as[5]=ct.getPath("image",as[5]);as[6]=ct.getPath("image",as[6]);as[13]=ct.getPath("image",as[13]);as[19]=ct.getPath("image",as[19]);as[25]=ct.getPath("image",as[25]);as[31]=ct.getPath("image",as[31]);}cn=cs.nodes[n]=new _e.node(cs.id+"_"+n,a[i].as);with(cn){rowId=_a++;nid=n;offsetPar=cs;uid=a[i].id;self=cs.self+".nodes["+n+"]";treeId=ct.nid;pSubTreeId=cs.nid;pNodeId=cs.pNodeId;flagWidth=cs.nid>0?ct.flagWidth:(ct.topFlag?ct.flagWidth:0);flagHeight=cs.nid>0||ct.topFlag?1:0;flagOutWidth=cs.flagOutWidth;attachEvent("click",cn.self+".select()");attachEvent("pressUp",cn.self+".up()");attachEvent("pressDown",cn.self+".down()");attachEvent("pressLeft",cn.self+".left()");attachEvent("pressRight",cn.self+".right()");attachEvent("mouseover",cn.self+".over();");attachEvent("mouseover",cn.self+".setStatus();");attachEvent("mouseout",cn.self+".out();");attachEvent("mouseout",cn.self+".reStatus();");if(clickAsFlag&&(!ct.showLevel1||cn.pSubTreeId>0)){attachEvent("click",cn.self+".expandOrCollapse()");}if(link&&link!="#_nolink"){cursor=ct.linkCursor=="hand"?"":ct.linkCursor;}else{cursor=ct.unlinkCursor=="hand"?"":ct.unlinkCursor;target="_self";attachEvent("click","false");}}_STJS.addObjById(cn.id,cn);break;}}if(ct){ct.createTree();}};this.tree=function(id,a){var _t=this,_r=_STJS,_e=_r._STTREE;_t.className="UITree";_t._ms={};_t._es={};_t.imgs={};_t.offsetPar=null;_t.subTrees=[];_t.self="";_t.id=id;_t.uid="";_t.nid=-1;_t.isMulti=_t._isMulti=false;_t.isShift=_t._isShift=false;_t.isCtrl=_t._isCtrl=false;_t.getHTML=_e.treeToHTML;_t.getPath=_e.getABSPath;_t.createTree=_e.createTree;_t.getEvent=_e.getTreeEvent;_t.buffImgs=_e.buffTreeImgs;_t.checkHL=_e.checkHighlight;_t.selected={};_t.getNextNode=null;_t.getPreviousNode=null;_t.getNextLink;_t.topSelected=null;_t.isEdit=false;_t.getState=_e.getTreeState;_t.setState=_e.setTreeState;_t.useCookie=0;a[1]+=a[1]&&a[1].charAt(a[1].length-1)!="/"?"/":"";if(!_r.isABSPath(a[3])){a[3]=a[1]+a[3];}if(_r.isFile(a[6])&&!_r.isABSPath(a[6])){a[6]=a[1]+a[6];}if(_r.isFile(a[7])&&!_r.isABSPath(a[7])){a[7]=a[1]+a[7];}if(!_r.isABSPath(a[17])){a[17]=a[1]+a[17];}if(!_r.isABSPath(a[20])){a[20]=a[1]+a[20];}if(!_r.isABSPath(a[21])){a[21]=a[1]+a[21];}if(!_r.isABSPath(a[25])){a[25]=a[1]+a[25];}if(!_r.isABSPath(a[26])){a[26]=a[1]+a[26];}if(!_r.isABSPath(a[27])){a[27]=a[1]+a[27];}if(!_r.isABSPath(a[28])){a[28]=a[1]+a[28];}if(_r.isFile(a[6])){a[6]="url("+a[6]+"),default";}if(_r.isFile(a[7])){a[7]="url("+a[7]+"),auto";}_t.spacing=3;_t.padding=1;_t.flagAlign="center";with(_t){setA("autoHide",a,0);setA("imagePath",a,1);setA("linkPerfix",a,2);setA("blankGif",a,3);setA("type",a,4);setA("align",a,5);setA("unlinkCursor",a,6);setA("linkCursor",a,7);setA("isRow",a,8);setA("isRTL",a,9);setA("indent",a,10);setA("width",a,11);setA("height",a,12);setA("borderStyle",a,13);setA("borderWidth",a,14);setA("borderColor",a,15);setA("backgroundColor",a,16);setA("backgroundImage",a,17);setA("backgroundRepeat",a,18);setA("useFlag",a,19);setA("collapsedFlag",a,20);setA("expandedFlag",a,21);setA("flagWidth",a,22);setA("flagHeight",a,23);setA("useLine",a,24);setA("DRLine",a,25);setA("VRLine",a,26);setA("URLine",a,27);setA("VLine",a,28);setA("topFlag",a,29);setA("showLevel1",a,30);setA("spacing",a,31);setA("padding",a,32);setA("flagAlign",a,33);setA("saveState",a,34);setA("highlight",a,35);if(!useFlag){collapsedFlag=expandedFlag="";}}};this.tree.prototype=new _STJS.UIObj;this.subtree=function(id,a){var _t=this,_r=_STJS,_e=_r._STTREE;_t.flagOutWidth=-1;_t._ms={};_t._es={};_t.offsetPar=null;_t.className="UISubTree";_t.self="";_t.uid="";_t.padding=1;_t.getHTML=_e.subTreeToHTML;_t.getIndents=_e.getIndents;_t.getVLines=_e.getVLines;_t.collapse=_e.collapseSubTree;_t.expand=_e.expandSubTree;_t.id=id;_t.nid=-1;_t.treeId=-1;_t.pNodeId=-1;_t.pSubTreeId=-1;_t.depth=-1;_t.indents=[];_t.nodes=[];_t.vLines=0;_t.state=0;_t.setA("type",a,0);_t.setA("isExpand",a,1);};this.subtree.prototype=new _STJS.UIObj;this.node=function(id,a){var _t=this,_r=_STJS,_e=_r._STTREE;_t._ms={};_t._es={};_t.offsetPar=null;_t.className="UINode";_t.self="";_t.uid="";_t.id=id;_t.nid=-1;_t.lock=false;_t.rowId=-1;_t.treeId=-1;_t.pSubTreeId=-1;_t.sSubTreeId=-1;_t.pNodeId=-1;_t.link="#_nolink";_t.flagOutWidth=-1;_t.tabId=100;_t.collapsedFlag="";_t.expandedFlag="";_t.flagWidth=0;_t.flagHeight=0;_t.cursor="default";_t.state=0;_t.getHTML=_e.nodeToHTML;_t.getEvent=_e.getNodeEvent;_t.select=_e.selectNode;_t.selectX=_e.selectNodeX;_t.focus=_e.getFocus;_t.unselect=_e.unselectNode;_t.setCursor=_e.setNodeCursor;_t.expandOrCollapse=_e.expandOrCollapse;_t.up=_e.upNode;_t.down=_e.downNode;_t.left=_e.leftNode;_t.right=_e.rightNode;_t.setStatus=_e.setStatus;_t.reStatus=_e.reStatus;_t.over=_e.overNode;_t.out=_e.outNode;_t.setText=_e.setNodeText;_t.setBg=_e.setNodeBackground;_t.setIcon=_e.setNodeIcon;_t.setFlag=_e.setNodeFlag;_t.upDate=_e.upDateNode;with(_t){setA("text",a,0);setA("link",a,1);setA("target",a,2);setA("tip",a,3);setA("status",a,4);setA("collapsedIcon",a,5);setA("expandedIcon",a,6);setA("iconWidth",a,7);setA("iconHeight",a,8);setA("outFont",a,9);setA("outColor",a,10);setA("outDecoration",a,11);setA("outBgColor",a,12);setA("outBgImg",a,13);setA("outBgRep",a,14);setA("overFont",a,15);setA("overColor",a,16);setA("overDecoration",a,17);setA("overBgColor",a,18);setA("overBgImg",a,19);setA("overBgRep",a,20);setA("select_outFont",a,21);setA("select_outColor",a,22);setA("select_outDecoration",a,23);setA("select_outBgColor",a,24);setA("select_outBgImg",a,25);setA("select_outBgRep",a,26);setA("select_overFont",a,27);setA("select_overColor",a,28);setA("select_overDecoration",a,29);setA("select_overBgColor",a,30);setA("select_overBgImg",a,31);setA("select_overBgRep",a,32);setA("clickAsFlag",a,33);setA("type",a,34);setA("align",a,35);setA("valign",a,36);setA("tWidth",a,37);setA("tHeight",a,38);if(!type){text=_r.htmlCode(text);}tip=_r.htmlCode(tip);}};this.node.prototype=new _STJS.UIObj;this.treeToHTML=function(){var s="",_r=_STJS;with(this){s="<table class='sttb' cellpadding=0 cellspacing=0 align="+align+" id='"+id+"' style='";if(backgroundColor){s+="background-color:"+backgroundColor+";";}if(backgroundImage){s+="background-image:url("+backgroundImage+");";}if(backgroundRepeat){s+="background-repeat:"+backgroundRepeat+";";}s+="'><td class='sttd'><div class='stdv'  id='"+id+"_trdv' onmouseover='return _STJS.domEvent(event,this)' onmouseout='return _STJS.domEvent(event,this)' onkeydown='return _STJS.domEvent(event,this)'  style='padding:"+spacing+"px;";if(borderStyle!="none"&&borderWidth>0){s+="border-style:"+borderStyle+";";s+="border-width:"+borderWidth+"px;";s+="border-color:"+borderColor+";";}if(width>0||height>0){if(width>0){s+="width:"+_r.cssLen("dv",width,spacing,borderWidth,1)+"px;";}if(height>0){s+="height:"+_r.cssLen("dv",height,spacing,borderWidth,1)+"px;";}s+="overflow:auto;";}s+="'>";s+=subTrees[0].getHTML();s+="</div></td></table>";return s;}};this.getABSPath=function(t,s){var _t=this;if(!_STJS.isABSPath(s)){switch(t){case "image":s=_t.imagePath+s;break;case "link":s=_t.linkPerfix+s;break;default:s=_t.imagePath+s;}}if(t=="image"&&s&&!this.imgs[s]){this.imgs[s]=1;}else{if(t=="link"&&!s.toLowerCase().indexOf("javascript:")){s+=";void(0)";}}return s;};this.createTree=function(){this.buffImgs();_STJS.write(this.getHTML());};this.getTreeEvent=function(e,oid){var et=e.type?e.type:e,_r=_STJS,_e=_r._STTREE;switch(et){case "keydown":switch(e.keyCode){case 37:case 38:case 39:case 40:this.subTrees[0].nodes[0].focus();return false;}break;case "mouseover":this.isOV=1;break;case "mouseout":this.isOV=0;break;}return true;};this.buffTreeImgs=function(){if(!_STJS.isBuffImg){return;}var s="";for(var i in this.imgs){s+=_STJS.getTag("div","style='display:none;'",_STJS.getImgTag(i,-1,-1));}_STJS.write(s);};this.subTreeToHTML=function(){var s="",_r=_STJS,_e=_r._STTREE,i,sst,tr=_r.structs[this.treeId];with(this){for(i=0;i<nodes.length;i++){if(nodes[i].sSubTreeId!=-1&&(tr.subTrees[nodes[i].sSubTreeId].state&1)){sst=tr.subTrees[nodes[i].sSubTreeId];s+=nodes[i].getHTML();s+=sst.getHTML();}else{s+=nodes[i].getHTML();}}if(!nid){return "<table class='sttb' cellpadding=0 cellspacing=0 id='"+tr.id+"_tb' "+(tr.width>0?" width='100%'":"")+">"+s+"</table>";}else{return s;}}};this.getIndents=function(){var tr=_STJS.structs[this.treeId],ps=this.pSubTreeId!=-1?tr.subTrees[this.pSubTreeId]:0;with(this){if(nid>0){indents=indents.concat(ps.indents);indents.push(flagOutWidth);}else{if(tr.topFlag){indents.push(flagOutWidth);}}}};this.getVLines=function(){var st=this,tr=_STJS.structs[st.treeId],t,pn,vs=[];this.vLines=[];while(st.pNodeId!=-1){t=st;st=tr.subTrees[st.pSubTreeId];pn=st.nodes[t.pNodeId];if(pn.nid==(st.nodes.length-1)){vs.push("");}else{vs.push(tr.VLine);}}if(!tr.topFlag){vs.pop();}for(var i=vs.length-1;i>=0;i--){this.vLines.push(vs[i]);}};this.nodeToHTML=function(f){var _r=_STJS,_e=_r.STTREE,s="",tr=_r.structs[this.treeId],st=tr.subTrees[this.pSubTreeId],pn=st.pNodeId!=-1?tr.subTrees[st.pSubTreeId].nodes[st.pNode]:0,sum=0,i;with(this){if(!f){s+="<tr class='sttr'><td class='sttd'";if(tr.isRow){s+=" style='background-color:";switch(state&6){case 0:s+=outBgColor;break;case 2:s+=overBgColor;break;case 4:s+=select_outBgColor;break;case 6:s+=select_overBgColor;break;}s+=";background-image:url(";switch(state&6){case 0:s+=outBgImg;break;case 2:s+=overBgImg;break;case 4:s+=select_outBgImg;break;case 6:s+=select_overBgImg;break;}s+=");background-repeat:";switch(state&6){case 0:s+=outBgRep;break;case 2:s+=overBgRep;break;case 4:s+=select_outBgRep;break;case 6:s+=select_overBgRep;break;}s+="'";}s+=">";}if(tr.useLine&&!st.vLines){st.getVLines();}s+="<table class='sttb' cellpadding="+st.padding+" cellspacing=0 id='"+id+"' style=''>";for(i=0;i<st.indents.length-1;i++){if(tr.useLine&&st.indents[i]>0){s+="<td class='sttd' class='sttd' width="+_r.cssLen("td",st.indents[i],st.padding)+" algin='center' style='background:url("+st.vLines[i]+") no-repeat center;'>"+_r.getImgTag(tr.blankGif,st.indents[i]-2*st.padding,1,0)+"</td>";}else{sum+=st.indents[i];}}if(sum>0){s+="<td class='sttd' class='sttd' width="+_r.cssLen("td",sum,st.padding)+">"+_r.getImgTag(tr.blankGif,sum-2*st.padding,1,0)+"</td>";}if(st.indents.length&&st.indents[st.indents.length-1]){s+="<td class='sttd' class='sttd' width="+_r.cssLen("td",st.indents[st.indents.length-1],st.padding)+" align='"+tr.flagAlign+"'";if(tr.useLine){s+=" style='background:url("+(!nid&&!pSubTreeId?(nid!=st.nodes.length-1?tr.DRLine:""):(nid==st.nodes.length-1?tr.URLine:tr.VRLine))+") no-repeat center;'";}s+=">"+((collapsedFlag||expandedFlag)&&(!tr.showLevel1||pSubTreeId)?"<a class='sta' href='#' id='"+id+"_flag' tabindex="+tabId+" onclick='return _STJS.domEvent(event,this)'"+" >":"")+_r.getImgTag(state&1?(expandedFlag?expandedFlag:tr.blankGif):(collapsedFlag?collapsedFlag:tr.blankGif),tr.indent>-1?(tr.indent<flagWidth+2*st.padding?Math.max(1,tr.indent-2*st.padding):flagWidth):((state&1)&&!expandedFlag||!(state&1)&&!collapsedFlag?(flagOutWidth-2*st.padding):flagWidth),flagHeight,0,id+"_flagImg")+((collapsedFlag||expandedFlag)&&(!tr.showLevel1||pSubTreeId)?"</a>":"")+"</td>";}s+=(iconWidth&&iconHeight?"<td class='sttd' width="+_r.cssLen("td",(iconWidth+2*st.padding),st.padding)+" align='center'>"+(sSubTreeId!=-1?"<a href='#' tabindex="+tabId+" onclick='return _STJS.domEvent(event,this)' id='"+id+"_ico'>":"")+_r.getImgTag(state&1?(expandedIcon?expandedIcon:tr.blankGif):(collapsedIcon?collapsedIcon:tr.blankGif),iconWidth,iconHeight,0,id+"_icoImg")+(sSubTreeId!=-1?"</a>":"")+"</td>":"")+"<td class='sttd' id="+id+"_ttd align="+align+" valign="+valign+" style='";if(tWidth){var len=0;if(tr.isRow){if(sum){len=sum;}else{for(i=0;i<st.indents.length;i++){len+=st.indents[i];}}len+=iconWidth&&iconHeight?iconWidth+2*st.padding:0;}s+="width:"+_r.cssLen("td",tWidth-len,st.padding,0,1)+"px;";}if(tHeight){s+="height:"+_r.cssLen("td",tHeight,st.padding,0,1,false)+"px;";}if(!tr.isRow){s+="background-color:";switch(state&6){case 0:s+=outBgColor;break;case 2:s+=overBgColor;break;case 4:s+=select_outBgColor;break;case 6:s+=select_overBgColor;break;}s+=";background-image:url(";switch(state&6){case 0:s+=outBgImg;break;case 2:s+=overBgImg;break;case 4:s+=select_outBgImg;break;case 6:s+=select_overBgImg;break;}s+=");background-repeat:";switch(state&6){case 0:s+=outBgRep;break;case 2:s+=overBgRep;break;case 4:s+=select_outBgRep;break;case 6:s+=select_overBgRep;break;}}s+="' nowrap>";s+="<a class='sta' href=\""+(!link||link=="#_nolink"?"#":link.replace(/\"/g,"&quot;").replace(/\'/g,"&#39;"))+"\" target='"+target+"' id='"+id+"_link'"+" tabindex="+tabId+" onmouseover='return _STJS.domEvent(event,this)' onmouseout='return _STJS.domEvent(event,this)' onclick='return _STJS.domEvent(event,this)' onkeydown='return _STJS.domEvent(event,this);'"+(tip?" title=\""+tip+"\"":"")+" style=\""+(cursor?"cursor:"+cursor:"")+";white-space:nowrap;font:";switch(state&6){case 0:s+=outFont;break;case 2:s+=overFont;break;case 4:s+=select_outFont;break;case 6:s+=select_overFont;break;}s+=";text-decoration:";switch(state&6){case 0:s+=outDecoration;break;case 2:s+=overDecoration;break;case 4:s+=select_outDecoration;break;case 6:s+=select_overDecoration;break;}s+=";color:";switch(state&6){case 0:s+=outColor;break;case 2:s+=overColor;break;case 4:s+=select_outColor;break;case 6:s+=select_overColor;break;}s+=";\">"+text+"</a>";if(_r.isMIE){s+="&nbsp;";}s+="</td>";s+="</table>";s+=!f?"</td></tr>":"";return s;}};this.getNodeEvent=function(e,oid){var et=e.type?e.type:e;with(this){switch(et){case "mouseover":return fire("mouseover");case "mouseout":return fire("mouseout");case "click":if(oid==id+"_flag"){return fire("clickFlag");}else{if(oid==id+"_ico"){return fire("clickIcon");}else{var tr=_STJS.structs[this.treeId];if(e.shiftKey){tr._isShift=tr.isShift;tr.isShift=true;}if(e.ctrlKey){tr._isCtrl=tr.isCtrl;tr.isCtrl=true;}var r=fire("click");tr.isShift=tr._isShift;tr.isCtrl=tr._isCtrl;return r;}}case "keydown":switch(e.keyCode){case 37:return fire("pressLeft");case 38:return fire("pressUp");case 39:return fire("pressRight");case 40:return fire("pressDown");default:return true;}default:return fire(et);}}};this.getNodeTR=function(id){var _r=_STJS,nd;if(nd=_r.$(id)){return _r.isIE?nd.parentElement.parentElement:nd.parentNode.parentNode;}else{return false;}};this.setNodeCursor=function(s){var n;this.cursor=s;if(n=_STJS.$(this.id+"_link")){n.style.cursor=s;}};this.selectNode=function(){var _r=_STJS,_e=_r._STTREE;tr=_r.structs[this.treeId];if(tr.isMulti&&tr.isCtrl){}else{if(tr.isMulti&&tr.isShift&&tr.topSelected){var tb=_r.$(tr.id+"_tb"),c=_e.getNodeTR(this.id),_51=c.rowIndex,l=_e.getNodeTR(tr.topSelected.id),_53=l.rowIndex,_54={},f=0;if(_53<_51){f=1;}else{if(_53>_51){f=-1;}}if(f){for(var i=_53;i!=_51;i+=f){var o=_r.getObjById(tb.rows[i].id);if(o){if(!(o.state&4)){tr.selected[o.id]=o;o.state|=4;o.upDate();}_54[o.id]=1;}}}for(var i in tr.selected){if(!_54[i]){tr.selected[i].unselect();}}}else{for(var i in tr.selected){tr.selected[i].unselect();}}}tr.selected[this.id]=this;if(!tr.topSelected||!tr.isMulti||!(tr.isCtrl||tr.isShift)||tr.topSelected.rowId>=this.rowId){tr.topSelected=this;}if(this.state&4){return true;}with(this){state|=4;upDate();}return true;};this.getFocus=function(){_STJS.$(this.id+"_link").focus();return true;};this.unselectNode=function(){var tr=_STJS.structs[this.treeId];with(this){state&=11;upDate();if(tr.selected[id]){delete tr.selected[id];}}return true;};this.setNodeIcon=function(s){var e=_STJS.$(this.id+"_icoImg");if(e&&s&&e._s!=s){e.src=e._s=s;}return true;};this.setNodeFlag=function(s){var e=_STJS.$(this.id+"_flagImg");if(e&&e._s!=s){e.src=e._s=s;}return true;};this.setNodeText=function(f,c,d){var e=_STJS.$(this.id+"_link");if(e){with(e.style){if(font!=f){font=f;}if(color!=c){color=c;}if(textDecoration!=d){textDecoration=d;}}}return true;};this.setNodeBackground=function(c,i,r){var _r=_STJS,tr=_r.structs[this.treeId],e;if(tr.isRow){if(_r.isIE){e=_r.$(this.id)?_r.$(this.id).parentElement:0;}else{e=_r.$(this.id)?_r.$(this.id).parentNode:0;}}else{e=_r.$(this.id+"_ttd");}if(e){with(e.style){if(backgroundColor!=c){backgroundColor=c;}if(backgroundImage!=i&&backgroundImage!="url("+i+")"){if(!i){backgroundImage="";}else{backgroundImage="url("+i+")";}}if(backgroundRepeat!=r){backgroundRepeat=r;}}}return true;};this.upDateNode=function(){var _t=this,_s=_t.state,tr=_STJS.structs[this.treeId];with(this){if(_s&1){setIcon(_t.expandedIcon?_t.expandedIcon:tr.blankGif);setFlag(_t.expandedFlag?_t.expandedFlag:tr.blankGif);}else{setIcon(_t.collapsedIcon?_t.collapsedIcon:tr.blankGif);setFlag(_t.collapsedFlag?_t.collapsedFlag:tr.blankGif);}if(_s&4){if(_s&2){setText(_t.select_overFont,_t.select_overColor,_t.select_overDecoration);setBg(_t.select_overBgColor,_t.select_overBgImg,_t.select_overBgRep);}else{setText(_t.select_outFont,_t.select_outColor,_t.select_outDecoration);setBg(_t.select_outBgColor,_t.select_outBgImg,_t.select_outBgRep);}}else{if(_s&2){setText(_t.overFont,_t.overColor,_t.overDecoration);setBg(_t.overBgColor,_t.overBgImg,_t.overBgRep);}else{setText(_t.outFont,_t.outColor,_t.outDecoration);setBg(_t.outBgColor,_t.outBgImg,_t.outBgRep);}}}return true;};this.rightNode=function(){var _r=_STJS,_e=_r._STTREE,tr=_r.structs[this.treeId],o=this;if(o.sSubTreeId>0){if(o.state&1){var l=tr.subTrees[o.sSubTreeId].nodes[0];l.focus();}else{o.expandOrCollapse();}}return false;};this.leftNode=function(){var _r=_STJS,_e=_r._STTREE,tr=_r.structs[this.treeId],o=this;if(o.sSubTreeId>0&&(o.state&1)){o.expandOrCollapse();}else{if(o.pNodeId!=-1){var _73=tr.subTrees[o.pSubTreeId].pSubTreeId,l=tr.subTrees[_73].nodes[o.pNodeId];l.focus();}}return false;};this.upNode=function(){var o=this,i,_r=_STJS,_e=_r._STTREE,tr=_r.structs[o.treeId],tb=_r.$(tr.id+"_tb"),cur=_e.getNodeTR(o.id),crd=cur.rowIndex,eid,ob;for(i=crd-1;i>=0;i--){if(tb.rows[i].style.display!="none"){if(_r.isIE){eid=tb.rows[i].cells[0].children[0].id;}else{eid=tb.rows[i].cells[0].childNodes[0].id;}ob=_r.getObjById(eid);if(ob){ob.focus();}break;}}return false;};this.downNode=function(){var o=this,i,_r=_STJS,_e=_r._STTREE,tr=_r.structs[o.treeId],tb=_r.$(tr.id+"_tb"),cur=_e.getNodeTR(o.id),crd=cur.rowIndex,eid,ob;if(crd==tb.rows.length-1){crd=-1;}for(var i=crd+1;i<tb.rows.length;i++){if(tb.rows[i].style.display!="none"){if(_r.isIE){eid=tb.rows[i].cells[0].children[0].id;}else{eid=tb.rows[i].cells[0].childNodes[0].id;}ob=_r.getObjById(eid);if(ob){ob.focus();}break;}}return false;};this.overNode=function(){with(this){if(state&2){return true;}state|=2;upDate();}return true;};this.outNode=function(){with(this){if(!(state&2)){return true;}state&=13;upDate();}return true;};this.setStatus=function(){if(this.status){window.status=this.status;return true;}else{if(!this.link||this.link=="#_nolink"){return true;}}return false;};this.reStatus=function(){if(this.status){window.status="";return true;}else{if(!this.link||this.link=="#_nolink"){return true;}}return false;};this.expandOrCollapse=function(){if(this.lock){return true;}var _t=this,_r=_STJS,_e=_r._STTREE,tr=_r.structs[_t.treeId],sub=_t.sSubTreeId!=-1?tr.subTrees[_t.sSubTreeId]:0;if(sub){if(_t.state&1){sub.collapse();_t.state&=14;_t.upDate();}else{sub.expand();_t.state|=1;_t.upDate();if(tr.autoHide){for(var i=0;i<tr.subTrees[_t.pSubTreeId].nodes.length;i++){if(i==_t.nid){continue;}var nd=tr.subTrees[_t.pSubTreeId].nodes[i],st=nd.sSubTreeId==-1?0:tr.subTrees[nd.sSubTreeId];if(st&&st.state&1){st.collapse();nd.state&=14;nd.upDate();}}}}}return true;};this.getTreeState=function(t){var tr=this;var st=[],s=t+"%";for(var i=1;i<tr.subTrees.length;i++){if(t==1){if(tr.subTrees[i].state&1){st[i]=1,st[tr.subTrees[i].pSubTreeId]=0;}}}if(t==1){for(var i=1;i<st.length;i++){if(st[i]){s+=_STJS.trans10toX(64,tr.subTrees[i].pSubTreeId)+"-"+_STJS.trans10toX(64,tr.subTrees[i].pNodeId)+",";}}for(var i in tr.selected){s+=_STJS.trans10toX(64,tr.selected[i].pSubTreeId)+"+"+_STJS.trans10toX(64,tr.selected[i].nid)+",";}}if(s.length<=2){return "";}else{return s;}};this.setTreeState=function(s){var tr=this,i,j;for(i=0;i<s.length;i++){if(!s[i].isS&&tr.subTrees[s[i].sid]&&tr.subTrees[s[i].sid].nodes[s[i].nid]&&tr.subTrees[s[i].sid].nodes[s[i].nid].sSubTreeId!=-1){var o=tr.subTrees[tr.subTrees[s[i].sid].nodes[s[i].nid].sSubTreeId],_r=_STJS,pn;while(!(tr.subTrees[o.pSubTreeId].state&1)){pn=o.pNodeId;o=tr.subTrees[o.pSubTreeId];o.nodes[pn].state|=1;}o.expand();tr.subTrees[o.pSubTreeId].nodes[o.pNodeId].state|=1;tr.subTrees[o.pSubTreeId].nodes[o.pNodeId].upDate();}else{if(s[i].isS&&tr.subTrees[s[i].sid]&&tr.subTrees[s[i].sid].nodes[s[i].nid]){tr._isCtrl=tr.isCtrl;tr.isCtrl=true;s[i].isS&&tr.subTrees[s[i].sid]&&tr.subTrees[s[i].sid].nodes[s[i].nid].select();tr.isCtrl=tr._isCtrl;}}}};this.transTreeCookie=function(s){var v,vs,i,re,r=[],t;if(s.charAt(1)=="%"){v=s.substr(2);vs=v.split(",");switch(s.charAt(0)){case "1":re=/([0-9a-zA-Z#@]+)(\+|\-)([0-9a-zA-Z#@]+)/;for(i=0;i<vs.length;i++){t=re.exec(vs[i]);if(t){r[i]={sid:_STJS.transXto10(64,t[1]),nid:_STJS.transXto10(64,t[3]),isS:t[2]&&t[2]=="+"?1:0};}}break;case "2":re=/([0-9a-zA-Z]+)(\+|\-)([0-9a-zA-Z]+)(\+|\-)?/;for(i=0;i<vs.length;i++){t=re.exec(vs[i]);if(t){r[i]={cKey:t[1],pKey:t[3],isS:t[2]&&t[2]=="+"?1:0,isE:t[4]&&t[4]=="+"?1:0};}}break;}return r;}return false;};this.setTreeCookie=function(o){_STJS.saveCookie(o.uid,o.getState(1),365*24*60*60*1000);};this.getTreeCookie=function(o){var _r=_STJS,_e=_r._STTREE,s="";s=_r.readCookieByName(o.uid);if(!s){return;}else{o.setState(_e.transTreeCookie(s,1));}};this.selectNodeX=function(){var _t=this,_r=_STJS,_e=_r._STTREE,ss=[],pns=[],tr=_r.structs[_t.treeId],st=tr.subTrees[_t.pSubTreeId];if(_t.pSubTreeId!=-1&&!(tr.subTrees[_t.pSubTreeId].state&1)){while(st&&!(st.state&1)){ss.push(st);pns.push(st.pNodeId);st=tr.subTrees[st.pSubTreeId];}}for(var i=ss.length-1;i>=0;i--){if(pns!=-1){var nd=tr.subTrees[ss[i].pSubTreeId].nodes[pns[i]];nd.state|=1;nd.upDate();}ss[i].expand();}_t.select();};this.expandSubTree=function(f){if(this.state&1){return true;}var _t=this;if(_t.pNodeId==-1){return true;}var _r=_STJS,_e=_r._STTREE,tr=_r.structs[_t.treeId],i,sid,sst,ps,rtr,t,td,ttb=_r.$(tr.id+"_tb"),ctr=_e.getNodeTR(tr.subTrees[_t.pSubTreeId].nodes[_t.pNodeId].id),cid=ctr?ctr.rowIndex+1:0;for(i=0;i<_t.nodes.length;i++){if(rtr=_e.getNodeTR(_t.nodes[i].id)){rtr.style.display="";_t.nodes[i].upDate();}else{t=_r.isMIE?_r.$C("tr"):ttb.insertRow(cid+i);if(t){t.className="sttr";td=_r.isMIE?_r.$C("td"):t.insertCell(0);if(td){td.className="sttd";if(tr.isRow){with(_t.nodes[i]){switch(state&6){case 0:s=outBgColor+" url("+outBgImg+") "+outBgRep;break;case 2:s=overBgColor+" url("+overBgImg+") "+overBgRep;break;case 4:s=select_outBgColor+" url("+select_outBgImg+") "+select_outBgRep;break;case 6:s=select_overBgColor+" url("+select_overBgImg+") "+select_overBgRep;break;}td.style.background=s;}}td.innerHTML=_t.nodes[i].getHTML(1);if(_r.isMIE){t.appendChild(td);if(ttb.children[0].children.length<(cid+i+1)){ttb.appendChild(t);}else{ttb.children[0].insertBefore(t,ttb.children[0].children[cid+i]);}}}}}}for(i=0;i<_t.nodes.length;i++){if((sid=_t.nodes[i].sSubTreeId)!=-1&&(_t.nodes[i].state&1)){if(sst=tr.subTrees[sid]){_t.nodes[i].state|=1;_t.nodes[i].upDate();sst.expand();}}else{_t.nodes[i].upDate();}}_t.state|=1;return true;};this.collapseSubTree=function(){if(!(this.state&1)){return true;}var st=this,_r=_STJS,_e=_r._STTREE,lf,row,tr,ctr=_r.structs[st.treeId],sid,sst;for(var i=0;i<st.nodes.length;i++){if((sid=st.nodes[i].sSubTreeId)!=-1){sst=ctr.subTrees[sid];if(sst&&(sst.state&1)){sst.collapse();}}tr=_e.getNodeTR(st.nodes[i].id);if(tr){tr.style.display="none";st.nodes[i].state&=13;}}st.state&=0;return true;};this.onTreeUpdate=function(t){_STJS._STTREE.setTreeCookie(t);};this.onExpandSubTree=function(o,r){var _r=_STJS,tr=_r.structs[o.treeId],i,pn;k;if(o.nid){var j,nds=[],sts=[o],f=0;for(i=0;i<sts.length;i++){for(j=0;j<sts[i].nodes.length;j++){if(sts[i].nodes[j].sSubTreeId!=-1){nds.push(sts[i].nodes[j]);sts.push(tr.subTrees[sts[i].nodes[j].sSubTreeId]);}}}for(j=0;j<nds.length;j++){if(r||nds[j].pSubTreeId==o.nid){nds[j].state|=1;}}if(!r){for(i=sts.length-1;i>0;i--){if(sts[i].state&1){sts[i].collapse(),f=1;}tr.subTrees[sts[i].pSubTreeId].nodes[sts[i].pNodeId].state&=14;tr.subTrees[sts[i].pSubTreeId].nodes[sts[i].pNodeId].upDate();}if(f){tr.getMsg("ST_UPDATE");return;}}else{for(i=sts.length-1;i>=0;i--){if(!(sts[i].state&1)){for(var k=i;k>=0;k--){sts[k].state&=0;}break;}}}while(!(tr.subTrees[o.pSubTreeId].state&1)){pn=o.pNodeId;o=tr.subTrees[o.pSubTreeId];o.nodes[pn].state|=1;}o.expand();tr.subTrees[o.pSubTreeId].nodes[o.pNodeId].state|=1;tr.subTrees[o.pSubTreeId].nodes[o.pNodeId].upDate();}else{for(i=0;i<o.nodes.length;i++){if(o.nodes[i].sSubTreeId!=-1){o.nodes[i].state|=1;o.nodes[i].upDate();_STJS._STTREE.onExpandSubTree(tr.subTrees[o.nodes[i].sSubTreeId],r);}}}tr.getMsg("ST_UPDATE");};this.onCollapseSubTree=function(o,r){var _r=_STJS,tr=_r.structs[o.treeId],i;if(o.nid){if(!r){tr.subTrees[o.pSubTreeId].nodes[o.pNodeId].state&=14;tr.subTrees[o.pSubTreeId].nodes[o.pNodeId].upDate();o.collapse();tr.getMsg("ST_UPDATE");return;}var j,sts=[o];for(i=0;i<sts.length;i++){for(j=0;j<sts[i].nodes.length;j++){if(sts[i].nodes[j].sSubTreeId!=-1){sts.push(tr.subTrees[sts[i].nodes[j].sSubTreeId]);}}}for(i=sts.length-1;i>=0;i--){if(sts[i].state&1){sts[i].collapse();}tr.subTrees[sts[i].pSubTreeId].nodes[sts[i].pNodeId].state&=14;tr.subTrees[sts[i].pSubTreeId].nodes[sts[i].pNodeId].upDate();}}else{for(i=0;i<o.nodes.length;i++){if(o.nodes[i].sSubTreeId!=-1){o.nodes[i].state&=14;o.nodes[i].upDate();_STJS._STTREE.onCollapseSubTree(tr.subTrees[o.nodes[i].sSubTreeId],r);}}}tr.getMsg("ST_UPDATE");};this.checkHighlight=function(){var f=0;if(this.isOV){return;}else{for(var i=0;i<this.subTrees.length;i++){for(var j=0;j<this.subTrees[i].nodes.length;j++){var n=this.subTrees[i].nodes[j];if(n.link&&n.link!="#_nolink"){if(_STJS.isLink(n.link,n.target,window,this.highlight&4)){if((n.state&4)&&(n.offsetPar.state&1)){continue;}if(f){this._isMulti=this.isMulti;this._isCtrl=this.isCtrl;this.isMulti=true;this.isCtrl=true;}n.selectX();if(this.highlight&2){n.attachEvent("click",n.self+".state & 8?false:true;");n.setCursor(this.unlinkCursor);}if(f){this.isMulti=this._isMulti;this.isCtrl=this._isCtrl;}n.state|=8;f=1;}else{if(n.state&8){n.setCursor(this.linkCursor);n.state&=6;n.upDate();}}}}}}};};_STJS._STTREE.init();}